<!doctype html>

<html lang="en">

<head>

	<title>Assignment 1: Simple Page</title>
	<meta charset="utf-8">
	<meta name="description" content="Assignment 1: Simple Page">
	<meta name="author" content="Chao (Martin) Zhou">
	
</head>

<body style="padding-left: 50px">

	<h1><img src="http://www.rice.edu/_images/rice-logo.jpg" width="200px" alt="Image Missing"> Registration Page for Ricebook</h1>

	<form id="usrform" method="get" action="formProcessor.html" onsubmit="return checkValidation()">

  		<input type="hidden" name="timeStamp">

		<p>Account Name: <br/>
		<small>Accept only upper or lower case letters and numbers, but may not start with a number</small><br/>
		<input type="text" name="accountName" pattern="([A-Za-z]){1}([A-Za-z0-9])*" required>
		</p>

		<p>Display Name (Optional): <br/>
		<input type="text" name="displayName" pattern="([A-Za-z0-9])*">
		</p>

		<p>Email Address: <br/>
		<input type="text" name="email" placeholder="x@x.xx" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{1,4}" required>
		</p>

		<p>Phone Number: <br/>
		<input type="text" name="telephone" pattern="\d{3}-\d{3}-\d{4}" placeholder="xxx-xxx-xxxx" required>
		</p>

		<p>Date Of Birth: <br/>
		<input type="date" name="birthday" required>
		</p>

		<p>Zipcode: <br/>
		<small>Must be 5-digit number</small><br/>
		<input type="text" name="zipCode" pattern="\d{5}" placeholder="xxxxx" required>
		</p>

		<p>Password: <br/>
		<input type="password" name="password" required>
		</p>

		<p>Password Confirmation: <br/>
		<input type="password" name="passwordConfirmation" required>
		</p>

		<input type="submit" value="Submit">

  		<input type="reset" value="Clear">

	</form>
</body>
</html>

<script type="text/javascript">

// Set the value of hidden field to be the time when the page is loaded
	var timeLoaded = new Date();
	timeLoaded = timeLoaded.getTime();
	document.getElementsByName("timeStamp")[0].value = timeLoaded;

	function checkValidation() {
		if (checkAge() && checkPassword()) {
			return true;
		} else {
			return false;
		}
	}

	function checkAge() {
		var dateOfBirth=new Date(document.getElementsByName("birthday")[0].value);
		var ageDiffMs = Date.now() - dateOfBirth.getTime();
		var ageDate = new Date(ageDiffMs);
		var age = Math.abs(ageDate.getUTCFullYear() - 1970);
		if (age < 18) {
	 		window.alert("User must be 18 years of age or older");
			return false;
		} else {
			return true;
		}
	}

	function checkPassword() {
		var password = document.getElementsByName('password')[0].value;
		var passwordConfirmation = document.getElementsByName('passwordConfirmation')[0].value;
		if (password != passwordConfirmation) {
	 		window.alert("The two passwords you enter don't match");
			return false;
		} else {
			return true;
		}
	}

</script>